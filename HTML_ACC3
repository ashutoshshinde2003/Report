(Invoke-WebRequest -Uri "https://your-apex-host/ords/f?p=APP_ID:PAGE" -Method Get).Headers



https://eresxpress-reports-cat.1dc.com/ords/catreport/r/cat/eresp103/reportslist?session=2175825886081


function preventClickjacking(){window.top!==window.self&&(window.top.location=window.self.location)}window.addEventListener("DOMContentLoaded",preventClickjacking),window.addEventListener("load",preventClickjacking),window.addEventListener("resize",preventClickjacking);

function preventClickjacking() {
    if (window.top !== window.self) {
        window.top.location = window.self.location;
    }
}

window.addEventListener('DOMContentLoaded', preventClickjacking);
window.addEventListener('load', preventClickjacking);
window.addEventListener('resize', preventClickjacking);








✅ 1. Cache-Control Missing (Sensitive Data Visible After Logout)

✅ Issue Summary

Browser cached sensitive report pages. After logging out, users could press Back and still see confidential data.

This violates OWASP A6 – Sensitive Data Exposure.


---

✅ Remediation Implemented

Updated Application → Security → Browser Security → HTTP Response Headers:

✅ Final Header Configuration

Cache-Control: no-store, no-cache, must-revalidate, max-age=0
Pragma: no-cache
Expires: 0

These headers ensure:

No caching in browser

No storing in disk/memory

Back button forces reload



---

✅ Verification Steps

✅ Step 1: Clear browser cache

✅ Step 2: Open any secured page

✅ Step 3: Logout

✅ Step 4: Press Back button

Expected: User is redirected to login page
Actual: Verified working – no page data displayed

✅ Step 5: Command Line Verification

PowerShell

(Invoke-WebRequest -Uri "https://<your-app-url>" -Method Get).Headers

Expected Output

Cache-Control : no-store, no-cache, must-revalidate, max-age=0
Pragma        : no-cache
Expires       : 0

✅ Verified – cache vulnerability resolved.


---

✅ 2. Clickjacking (Iframe Loading Allowed)

✅ Issue Summary

The application could be embedded inside an external website using <iframe> which may allow clickjacking attacks.


---

✅ Remediation Implemented

Added anti-clickjacking headers in Application → Security → Browser Security → HTTP Response Headers:

✅ Final Header Configuration

X-Frame-Options: SAMEORIGIN
Content-Security-Policy: frame-ancestors 'self';

These headers prevent any external domain from embedding the app.


---

✅ Verification Steps

✅ Step 1: Create a local HTML file

Create click.html:

<!DOCTYPE html>
<html>
<body>
<h3>Test Iframe</h3>
<iframe src="https://yourapp.com/ords/..." width="900" height="900"></iframe>
</body>
</html>

Open in browser → file shows “refused to connect”.

✅ Step 2: Command Line Verification

(Invoke-WebRequest -Uri "https://<your-app-url>" -Method Get).Headers["X-Frame-Options"]

Expected Output:

SAMEORIGIN

And:

(Invoke-WebRequest -Uri "https://<your-app-url>" -Method Get).Headers["Content-Security-Policy"]

Expected:

frame-ancestors 'self'

✅ Verified – iframe protection enforced.


---

✅ 3. Cookie Path Not Properly Scoped

✅ Issue Summary

Application cookies were sent for multiple directories on the server domain.
This widens the attack surface.


---

✅ Remediation Implemented

Modified Application → Shared Components → Security Attributes
using:

✅ Substitution String Rule

Path=/ords/catreport/r/cat/eresp103/; Secure; HttpOnly

This ensures:

The cookie is valid only for this application

Prevents it from being leaked to other paths

Reduces cross-application attack surface



---

✅ Verification Steps

✅ PowerShell Command

(Invoke-WebRequest -Uri "https://<your-app-url>" -Method Get).Headers["Set-Cookie"]

✅ Expected Output

ORA_WWV_APP_103=...; Path=/ords/catreport/r/cat/eresp103/; Secure; HttpOnly

✅ Verified – cookie path properly restricted.


---

✅ 4. Outdated jQuery Version (1.7.1)

✅ Issue Summary

APEX pages were loading an outdated jQuery 1.7.1 version with known CVEs (XSS, prototype pollution).


---

✅ Remediation Implemented

✅ Step 1: Update Compatibility Mode

Navigate to:

Application → Definition → Properties → Compatibility Mode → Set to Latest

This forces APEX to use the latest bundled jQuery (3.x).

✅ Step 2: Remove jQuery 1.x references

Checked:

Page JavaScript URLs

Static Files

Theme scripts


Ensured no page explicitly loads old jQuery.


---

✅ Verification Steps

✅ Browser Developer Tools → Network → Filter “jquery”

Expected:

jquery-3.x.x.min.js

Not expected:

jquery-1.7.1.js

✅ Verified – updated to current secure jQuery version.






^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$