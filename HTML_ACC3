SELECT COUNT(*)
FROM (
  SELECT 
      br1.pts_res_group_id,
      DECODE(pts.case_status_id, 20, 'Bad', 'Good') AS status
  FROM apex_mod.eres_bulk_res_upload_detail br1
  JOIN eresuser_owner.pts_case pts
    ON TO_NUMBER(br1.pts_res_group_id) = pts.pts_res_group_id
  WHERE br1.job_id = :JOB_ID
    AND br1.row_status = 'VALID'
  GROUP BY br1.pts_res_group_id, pts.case_status_id
)
WHERE status = 'Good'




SELECT COUNT(*)
FROM (
  SELECT 
      br1.pts_res_group_id,
      DECODE(pts.case_status_id, 20, 'Bad', 'Good') AS status
  FROM apex_mod.eres_bulk_res_upload_detail br1
  JOIN eresuser_owner.pts_case pts
    ON TO_NUMBER(br1.pts_res_group_id) = pts.pts_res_group_id
  WHERE br1.job_id = :JOB_ID
    AND br1.row_status = 'VALID'
  GROUP BY br1.pts_res_group_id, pts.case_status_id
)
WHERE status = 'Bad'








SELECT 
    job_id,
    submission,
    date_added,
    status,
    user_added,

    CASE 
      WHEN status = 'SUCCESSFUL' THEN
        -- disabled button
        '<button class="t-Button t-Button--danger t-Button--small" disabled>Cancel</button>'
        WHEN status = 'CANCELLED' THEN
        -- disabled button
        '<button class="t-Button t-Button--danger t-Button--small" disabled>Cancel</button>'
        WHEN status = 'FAILED' THEN
        -- disabled button
        '<button class="t-Button t-Button--danger t-Button--small" disabled>Cancel</button>'


      ELSE
        -- active button
        '<button class="t-Button t-Button--danger t-Button--small cancel-row" '||
        'data-jobid="'||job_id||'">Cancel</button>'
    END AS cancel_button

FROM bulk_resolution_data
ORDER BY job_id DESC;
